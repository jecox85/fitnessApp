<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Bodyweight Fitness: About</title>
    <link rel="stylesheet" href="../css/materialize.min.css">
    <!--Import Google Icon Font-->
    <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
    <link rel="stylesheet" href="/css/app.css">
    <link rel="manifest" href="../manifest.json">
    <script type="text/javascript" src="../js/materialize.min.js"></script>
</head>

<!--Top bar area-->
<body class="grey lighten-4">
<nav class="blue darken-3">
    <div class="nav-wrapper container">
        <b><span style="font-size: 170%; ">Bodyweight Fitness</span></b>
        <span class="right grey-text text-darken-3">
                <i class="material-icons sidenav-trigger" data-target="side-menu">menu</i>
            </span>
    </div>
</nav>

<!--side navigation pop-out-->
<ul id="side-menu" class="sidenav side-menu">
    <li><a class="subheader">BODYWEIGHT FITNESS</a></li>
    <li><a href="/index.html" class="waves-effect">Home</a></li>
    <li><a href="/pages/workoutStart.html" class="logged-in waves-effect">Start Workout</a></li>
    <li><a href="/pages/archive.html" class="logged-in waves-effect">History</a></li>
    <li><a href="/pages/about.html" class="waves-effect">About</a></li>
    <li class="logged-in">
        <a href="#" class="waves-effect modal-trigger" data-target="modal-account">Account</a>
    </li>
    <li class="logged-in">
        <a href="#" class="waves-effect" id="logout">Logout</a>
    </li>
    <li class="logged-out">
        <a href="#" class="waves-effect modal-trigger" data-target="modal-login">Login</a>
    </li>
    <li class="logged-out">
        <a href="#" class="waves-effect modal-trigger" data-target="modal-signup">Sign Up</a>
    </li>
</ul>
<!-- Sign Up modal -->
<div id="modal-signup" class="modal">
    <div class="modal-content">
        <h4>Sign Up</h4>
        <form id="signup-form">
            <div class="input-field">
                <input type="email" id="signup-email" required>
                <label for="signup-email">Email Address</label>
            </div>
            <div class="input-field">
                <input type="password" id="signup-password" required>
                <label for="signup-password">Choose Password</label>
            </div>
            <button class="btn blue darken-3 z-depth-0">Sign Up</button>  

        </form>
    </div>
</div>
<!-- login modal -->
<div id="modal-login" class="modal">
    <div class="modal-content">
        <h4>Login</h4><br>
        <form id="login-form">
            <div class="input-field">
                <input type="email" id="login-email" required>
                <label for="login-email">Email Address</label>
            </div>
            <div class="input-field">
                <input type="password" id="login-password" required>
                <label for="login-password">Your password</label>
            </div>
            <button class="btn blue darken-3 z-depth-0">Login</button> 
        </form>
    </div>
</div>
<!-- Account modal -->
<div id="modal-account" class="modal">
    <div class="modal-content center-align">
        <h4>Account Details</h4><br>
        <div class="account-details"></div>
    </div>
</div>


<!-- Content -->
<div class="container">
    <h5 class="center-align">Congratulations!</h5>
    <ul id="user-list"></ul>  
</div>

<div class="container"><p>Would you like to save your workout?</p></div>

<div class="container center-align">
    <button onclick id="saveBtn" class="waves-effect waves-light btn blue darken-3">Save</button>
</div>
<div class="container center-align">
    <button onclick="window.location.href='archive.html';" id="archiveBtn" class="waves-effect waves-light btn blue darken-3" style="display: none">See History</button>
</div>


<script src="/js/ui.js" type="text/javascript"></script>
<script src="/js/app.js"></script>
<script type="module" src ='/js/auth.js'></script>
<!-- Firebase stuff -->

<script type="module">
    let currentSession  = JSON.parse(sessionStorage.getItem("currentWorkout"));
    let currentDate = new Date().toDateString();
    
    // Import the functions you need from the SDKs you need
    import { initializeApp } from "https://www.gstatic.com/firebasejs/9.6.1/firebase-app.js";
    import { getAnalytics } from "https://www.gstatic.com/firebasejs/9.6.1/firebase-analytics.js";
    import { getFirestore, collection, getDocs, addDoc, doc, deleteDoc, query, where, updateDoc, enableIndexedDbPersistence } from "https://www.gstatic.com/firebasejs/9.6.1/firebase-firestore.js";
    // TODO: Add SDKs for Firebase products that you want to use
    // https://firebase.google.com/docs/web/setup#available-libraries

    // Your web app's Firebase configuration
    // For Firebase JS SDK v7.20.0 and later, measurementId is optional
    const firebaseConfig = {
    apiKey: "AIzaSyC7R_aMW6FCYxcWOmU_1RNaWB5aqJwAyPM",
    authDomain: "fitness-app-35745.firebaseapp.com",
    projectId: "fitness-app-35745",
    storageBucket: "fitness-app-35745.appspot.com",
    messagingSenderId: "111468032003",
    appId: "1:111468032003:web:1acf8f1fb184231f5f5e36",
    measurementId: "${config.measurementId}"
    };

    const app = initializeApp(firebaseConfig);
    const db = getFirestore(app);

    //save workout to database
    document.querySelector('#saveBtn').addEventListener('click', function(e){
        const docRef = addDoc(collection(db, "workouts"), {
            Date: currentDate,
            user: "Test1",
            workout: JSON.stringify(currentSession)
        });
        document.querySelector('#saveBtn').style.display = "none";
        document.querySelector('#archiveBtn').style.display = "inline";
       
    })
</script>
</body>

</html>